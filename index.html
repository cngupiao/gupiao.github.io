<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç³»ç»Ÿç›‘æ§ç»ˆç«¯</title>
    <style>
        /* åŸºç¡€é‡ç½® */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: all 0.3s ease;
        }
        
        body {
            font-family: 'Microsoft YaHei', sans-serif;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        /* çš®è‚¤åˆ‡æ¢æŒ‰é’® */
        .skin-toggle {
            position: fixed;
            top: 15px;
            right: 15px;
            width: 32px;
            height: 32px;
            background: rgba(0,0,0,0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 16px;
            z-index: 1000;
            backdrop-filter: blur(2px);
        }
        
        /* ========== é»˜è®¤ç®€çº¦é£æ ¼ ========== */
        body.default-mode {
            background: #f5f7fa;
        }
        .default-mode .container {
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.1);
            padding: 25px;
            width: 100%;
            max-width: 350px;
            text-align: center;
        }
        .default-mode .title {
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: #333;
        }
        .default-mode .input-group {
            display: flex;
            margin-bottom: 20px;
        }
        .default-mode #codeInput {
            flex: 1;
            padding: 12px;
            border: 1px solid #d9d9d9;
            border-radius: 4px;
            font-size: 16px;
            text-align: center;
        }
        .default-mode #syncButton {
            background: #1890ff;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 0 20px;
            margin-left: 10px;
            cursor: pointer;
        }
        .default-mode .status-box {
            padding: 20px 0;
        }
        .default-mode #displayValue {
            font-size: 2.8rem;
            margin: 15px 0;
            color: #1d39c4;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .default-mode #updateTime {
            color: #8c8c8c;
            font-size: 0.9rem;
        }
        .default-mode #errorMsg {
            color: #f5222d;
            min-height: 20px;
            font-size: 0.9rem;
        }
        .default-mode .fake-content {
            display: none;
        }

        /* ========== ITè¿ç»´ç›‘æ§é£æ ¼ ========== */
        body.it-mode {
            background: #0a0a12;
            font-family: 'Courier New', monospace;
            color: #00ff41;
            padding: 0;
        }
        .it-mode .container {
            width: 100%;
            max-width: 600px;
            background: #000;
            border: 1px solid #003b00;
            padding: 15px;
            box-shadow: 0 0 10px rgba(0,255,65,0.1);
        }
        .it-mode .header {
            display: flex;
            justify-content: space-between;
            border-bottom: 1px dashed #003b00;
            padding-bottom: 8px;
            margin-bottom: 15px;
        }
        .it-mode .title {
            color: #00ff41;
            font-size: 1.1rem;
        }
        .it-mode .server-info {
            color: #008f11;
            font-size: 0.9rem;
        }
        .it-mode .input-group {
            display: flex;
            margin-bottom: 15px;
        }
        .it-mode #codeInput {
            flex: 1;
            padding: 8px;
            background: #111;
            color: #00ff41;
            border: 1px solid #003b00;
            font-family: 'Courier New', monospace;
        }
        .it-mode #syncButton {
            background: #003b00;
            color: #00ff41;
            border: 1px solid #00ff41;
            padding: 0 15px;
            margin-left: 10px;
            font-family: 'Courier New', monospace;
        }
        .it-mode .status-box {
            border: 1px solid #003b00;
            padding: 15px;
            margin-bottom: 15px;
            min-height: 120px;
        }
        .it-mode #displayValue {
            color: #00ff41;
            text-shadow: 0 0 5px #00ff41;
            font-size: 2.5rem;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
        }
        .it-mode #updateTime {
            color: #008f11;
            font-size: 0.8rem;
            text-align: right;
        }
        .it-mode #errorMsg {
            color: #ff5555;
            font-size: 0.8rem;
            margin-top: 5px;
        }
        .it-mode .fake-content {
            color: #00ff41;
            font-size: 0.9rem;
            line-height: 1.5;
        }
        .it-mode .log-entry {
            margin-bottom: 5px;
        }
        .it-mode .log-entry:before {
            content: "> ";
        }
        .it-mode .blink {
            animation: blink 1s step-end infinite;
        }
        @keyframes blink {
            50% { opacity: 0; }
        }

        /* ========== ExcelæŠ¥è¡¨é£æ ¼ ========== */
        body.excel-mode {
            background: #e6e6e6;
            padding: 10px;
        }
        .excel-mode .container {
            width: 100%;
            max-width: 800px;
            background: white;
            box-shadow: none;
            border: 1px solid #ddd;
            padding: 15px;
        }
        .excel-mode .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 5px;
            border-bottom: 2px solid #1f4e79;
        }
        .excel-mode .title {
            color: #1f4e79;
            font-weight: bold;
            font-size: 1.1rem;
        }
        .excel-mode .excel-toolbar {
            display: flex;
            gap: 5px;
        }
        .excel-mode .tool-button {
            padding: 3px 8px;
            background: #f2f2f2;
            border: 1px solid #ddd;
            border-radius: 2px;
            font-size: 0.8rem;
            cursor: pointer;
        }
        .excel-mode .input-group {
            display: flex;
            margin-bottom: 15px;
        }
        .excel-mode #codeInput {
            flex: 1;
            padding: 8px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 0;
        }
        .excel-mode #syncButton {
            background: #1f4e79;
            color: white;
            border: none;
            border-radius: 0;
            padding: 0 15px;
            margin-left: 5px;
        }
        .excel-mode .status-box {
            margin-bottom: 15px;
        }
        .excel-mode #displayValue {
            color: #1f4e79;
            font-weight: bold;
            font-size: 2.2rem;
            border-bottom: 2px solid #1f4e79;
            padding-bottom: 10px;
            margin: 10px 0;
            justify-content: flex-start;
        }
        .excel-mode #updateTime {
            color: #7f7f7f;
            font-style: italic;
            font-size: 0.8rem;
            text-align: right;
        }
        .excel-mode #errorMsg {
            color: #c00000;
            font-size: 0.8rem;
            margin-top: 5px;
        }
        .excel-mode .fake-content {
            margin-top: 15px;
        }
        .excel-mode .data-table {
            width: 100%;
            border-collapse: collapse;
        }
        .excel-mode .data-table th {
            background: #f2f2f2;
            border: 1px solid #ddd;
            padding: 5px;
            text-align: left;
            font-weight: bold;
        }
        .excel-mode .data-table td {
            border: 1px solid #ddd;
            padding: 5px;
        }
        .excel-mode .cell-formula {
            font-style: italic;
            color: #0070c0;
        }

        /* ========== é‚®ä»¶ç³»ç»Ÿé£æ ¼ ========== */
        body.email-mode {
            background: #e5e5e5;
            padding: 20px;
        }
        .email-mode .container {
            width: 100%;
            max-width: 800px;
            background: white;
            border-top: 3px solid #0078d4;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            padding: 0;
        }
        .email-mode .email-header {
            padding: 15px;
            border-bottom: 1px solid #ddd;
        }
        .email-mode .email-subject {
            font-size: 1.1rem;
            font-weight: bold;
            margin-bottom: 10px;
            color: #0078d4;
        }
        .email-mode .email-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            font-size: 0.8rem;
            color: #666;
            margin-bottom: 10px;
        }
        .email-mode .email-toolbar {
            display: flex;
            gap: 10px;
            padding: 10px 15px;
            background: #f5f5f5;
            border-bottom: 1px solid #ddd;
        }
        .email-mode .tool-button {
            padding: 3px 10px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 3px;
            font-size: 0.8rem;
            cursor: pointer;
        }
        .email-mode .email-body {
            padding: 15px;
        }
        .email-mode .input-group {
            display: flex;
            margin: 15px 0;
        }
        .email-mode #codeInput {
            flex: 1;
            padding: 8px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 3px;
        }
        .email-mode #syncButton {
            background: #0078d4;
            color: white;
            border: none;
            border-radius: 3px;
            padding: 0 15px;
            margin-left: 10px;
        }
        .email-mode .status-box {
            margin: 15px 0;
            padding: 15px;
            background: #f9f9f9;
            border: 1px solid #eee;
        }
        .email-mode #displayValue {
            color: #d83b01;
            font-weight: bold;
            font-size: 2.2rem;
            margin: 10px 0;
        }
        .email-mode #updateTime {
            color: #666;
            font-size: 0.8rem;
            text-align: right;
        }
        .email-mode #errorMsg {
            color: #d83b01;
            font-size: 0.8rem;
            margin-top: 5px;
        }
        .email-mode .email-footer {
            padding: 10px 15px;
            background: #f5f5f5;
            border-top: 1px solid #ddd;
            font-size: 0.8rem;
            color: #666;
            text-align: center;
        }

        /* ========== é¡¹ç›®ç®¡ç†é£æ ¼ ========== */
        body.jira-mode {
            background: #f4f5f7;
            padding: 15px;
        }
        .jira-mode .container {
            width: 100%;
            max-width: 1000px;
            background: white;
            border-radius: 3px;
            box-shadow: 0 1px 1px rgba(9,30,66,.25);
            padding: 0;
        }
        .jira-mode .jira-header {
            padding: 10px 15px;
            background: #0052cc;
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .jira-mode .jira-logo {
            font-weight: bold;
        }
        .jira-mode .jira-nav {
            display: flex;
            gap: 15px;
            font-size: 0.9rem;
        }
        .jira-mode .jira-nav-item {
            cursor: pointer;
        }
        .jira-mode .jira-content {
            display: flex;
            min-height: 500px;
        }
        .jira-mode .jira-sidebar {
            width: 200px;
            padding: 15px;
            background: #f4f5f7;
            border-right: 1px solid #dfe1e6;
        }
        .jira-mode .sidebar-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: #5e6c84;
        }
        .jira-mode .sidebar-menu {
            list-style: none;
        }
        .jira-mode .sidebar-menu li {
            padding: 5px 0;
            cursor: pointer;
        }
        .jira-mode .sidebar-menu li:hover {
            color: #0052cc;
        }
        .jira-mode .jira-main {
            flex: 1;
            padding: 15px;
        }
        .jira-mode .jira-issue {
            background: white;
            border-radius: 3px;
            box-shadow: 0 1px 1px rgba(9,30,66,.25);
            padding: 15px;
            margin-bottom: 15px;
        }
        .jira-mode .issue-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 1px solid #dfe1e6;
        }
        .jira-mode .issue-key {
            font-weight: bold;
            color: #0052cc;
        }
        .jira-mode .issue-status {
            background: #dfe1e6;
            padding: 2px 5px;
            border-radius: 3px;
            font-size: 0.8rem;
        }
        .jira-mode .input-group {
            display: flex;
            margin: 15px 0;
        }
        .jira-mode #codeInput {
            flex: 1;
            padding: 8px;
            background: #fafbfc;
            border: 1px solid #dfe1e6;
            border-radius: 3px;
        }
        .jira-mode #syncButton {
            background: #0052cc;
            color: white;
            border: none;
            border-radius: 3px;
            padding: 0 15px;
            margin-left: 10px;
        }
        .jira-mode .status-box {
            margin: 15px 0;
        }
        .jira-mode #displayValue {
            color: #172b4d;
            font-size: 2rem;
            margin: 10px 0;
            padding-left: 10px;
            border-left: 3px solid #0052cc;
            justify-content: flex-start;
        }
        .jira-mode #updateTime {
            color: #5e6c84;
            font-size: 0.8rem;
            text-align: right;
        }
        .jira-mode #errorMsg {
            color: #de350b;
            font-size: 0.8rem;
            margin-top: 5px;
        }
        .jira-mode .jira-footer {
            padding: 10px 15px;
            background: #f4f5f7;
            border-top: 1px solid #dfe1e6;
            font-size: 0.8rem;
            color: #5e6c84;
            text-align: center;
        }

        /* ========== æ•°æ®åº“æŸ¥è¯¢é£æ ¼ ========== */
        body.sql-mode {
            background: #1e1e1e;
            padding: 0;
            font-family: Consolas, 'Courier New', monospace;
        }
        .sql-mode .container {
            width: 100%;
            max-width: 1000px;
            background: #252526;
            border: 1px solid #3c3c3c;
            padding: 0;
        }
        .sql-mode .sql-toolbar {
            padding: 8px 15px;
            background: #2d2d30;
            border-bottom: 1px solid #3c3c3c;
            display: flex;
            gap: 10px;
        }
        .sql-mode .sql-button {
            padding: 3px 10px;
            background: #3e3e42;
            color: #d4d4d4;
            border: none;
            border-radius: 2px;
            font-family: Consolas, 'Courier New', monospace;
            font-size: 0.8rem;
            cursor: pointer;
        }
        .sql-mode .sql-content {
            display: flex;
            min-height: 500px;
        }
        .sql-mode .sql-sidebar {
            width: 200px;
            padding: 15px;
            background: #252526;
            border-right: 1px solid #3c3c3c;
            color: #9cdcfe;
        }
        .sql-mode .database-list {
            list-style: none;
            margin-top: 10px;
        }
        .sql-mode .database-list li {
            padding: 3px 0;
            cursor: pointer;
        }
        .sql-mode .database-list li:hover {
            color: #ce9178;
        }
        .sql-mode .sql-main {
            flex: 1;
            padding: 15px;
        }
        .sql-mode .query-editor {
            background: #1e1e1e;
            border: 1px solid #3c3c3c;
            padding: 10px;
            margin-bottom: 15px;
            color: #d4d4d4;
        }
        .sql-mode .input-group {
            display: flex;
            margin: 15px 0;
        }
        .sql-mode #codeInput {
            flex: 1;
            padding: 8px;
            background: #252526;
            color: #9cdcfe;
            border: 1px solid #3c3c3c;
            font-family: Consolas, 'Courier New', monospace;
        }
        .sql-mode #syncButton {
            background: #0e639c;
            color: white;
            border: none;
            border-radius: 2px;
            padding: 0 15px;
            margin-left: 10px;
            font-family: Consolas, 'Courier New', monospace;
        }
        .sql-mode .status-box {
            margin: 15px 0;
        }
        .sql-mode #displayValue {
            color: #b5cea8;
            font-size: 2rem;
            margin: 10px 0;
            font-family: Consolas, 'Courier New', monospace;
        }
        .sql-mode #updateTime {
            color: #888;
            font-size: 0.8rem;
            text-align: right;
            font-family: Consolas, 'Courier New', monospace;
        }
        .sql-mode #errorMsg {
            color: #f48771;
            font-size: 0.8rem;
            margin-top: 5px;
            font-family: Consolas, 'Courier New', monospace;
        }
        .sql-mode .query-results {
            margin-top: 15px;
            color: #d4d4d4;
        }
        .sql-mode .result-table {
            width: 100%;
            border-collapse: collapse;
        }
        .sql-mode .result-table th {
            background: #2d2d30;
            border: 1px solid #3c3c3c;
            padding: 5px;
            text-align: left;
        }
        .sql-mode .result-table td {
            border: 1px solid #3c3c3c;
            padding: 5px;
        }
    </style>
</head>
<body class="default-mode">
    <!-- çš®è‚¤åˆ‡æ¢æŒ‰é’® -->
    <div class="skin-toggle" id="skinToggle">ğŸ¨</div>
    
    <!-- é»˜è®¤ç®€çº¦é£æ ¼å®¹å™¨ -->
    <div class="container default-container">
        <div class="title">æ•°æ®ç›‘æ§é¢æ¿</div>
        
        <div class="input-group">
            <input 
                type="text" 
                id="codeInput" 
                placeholder="è¾“å…¥6ä½æ•°å­—ç¼–ç "
                maxlength="6"
                onkeypress="if(event.key==='Enter') startTracking()"
            >
            <button id="syncButton" onclick="startTracking()">æŸ¥è¯¢</button>
        </div>
        
        <div class="status-box">
            <div id="displayValue">--.--</div>
            <div id="updateTime">æœ€ååŒæ­¥: --:--:--</div>
            <div id="errorMsg"></div>
        </div>
    </div>
    
    <!-- ITè¿ç»´ç›‘æ§é£æ ¼å®¹å™¨ -->
    <div class="container it-container" style="display:none">
        <div class="header">
            <div class="title">æœåŠ¡å™¨çŠ¶æ€ç›‘æ§</div>
            <div class="server-info">SERVER-01 | CPU: 42% | MEM: 64%</div>
        </div>
        
        <div class="input-group">
            <input 
                type="text" 
                id="itCodeInput" 
                placeholder="è¾“å…¥è®¾å¤‡ç¼–å·"
                maxlength="6"
            >
            <button id="itSyncButton">æ‰§è¡Œ</button>
        </div>
        
        <div class="status-box">
            <div id="itDisplayValue">--.--</div>
            <div id="itUpdateTime">æœ€åæ›´æ–°: --:--:--</div>
            <div id="itErrorMsg"></div>
        </div>
        
        <div class="fake-content">
            <div class="log-entry">ç³»ç»Ÿå¯åŠ¨å®Œæˆï¼Œæ‰€æœ‰æœåŠ¡æ­£å¸¸è¿è¡Œ</div>
            <div class="log-entry">å†…å­˜ä½¿ç”¨ç‡: 64%</div>
            <div class="log-entry">CPUæ¸©åº¦: 42Â°C</div>
            <div class="log-entry">ç½‘ç»œçŠ¶æ€: ç¨³å®š <span class="blink">_</span></div>
        </div>
    </div>
    
    <!-- ExcelæŠ¥è¡¨é£æ ¼å®¹å™¨ -->
    <div class="container excel-container" style="display:none">
        <div class="header">
            <div class="title">è´¢åŠ¡æ•°æ®æŠ¥è¡¨</div>
            <div class="excel-toolbar">
                <div class="tool-button">æ–‡ä»¶</div>
                <div class="tool-button">å¼€å§‹</div>
                <div class="tool-button">æ’å…¥</div>
                <div class="tool-button">æ•°æ®</div>
            </div>
        </div>
        
        <div class="input-group">
            <input 
                type="text" 
                id="excelCodeInput" 
                placeholder="è¾“å…¥é¡¹ç›®ç¼–å·"
                maxlength="6"
            >
            <button id="excelSyncButton">åˆ·æ–°</button>
        </div>
        
        <div class="status-box">
            <div id="excelDisplayValue">--.--</div>
            <div id="excelUpdateTime">æ›´æ–°æ—¶é—´: --:--:--</div>
            <div id="excelErrorMsg"></div>
        </div>
        
        <div class="fake-content">
            <table class="data-table">
                <tr>
                    <th>æ—¥æœŸ</th>
                    <th>é¡¹ç›®</th>
                    <th>æ•°å€¼</th>
                </tr>
                <tr>
                    <td>2023-12-01</td>
                    <td>KPI-01</td>
                    <td>92.5</td>
                </tr>
                <tr>
                    <td>2023-12-01</td>
                    <td>KPI-02</td>
                    <td>87.2</td>
                </tr>
                <tr>
                    <td>=TODAY()</td>
                    <td class="cell-formula">=VLOOKUP(A3,A1:C2,3,FALSE)</td>
                    <td id="excelDisplayCode">--.--</td>
                </tr>
            </table>
        </div>
    </div>
    
    <!-- é‚®ä»¶ç³»ç»Ÿé£æ ¼å®¹å™¨ -->
    <div class="container email-container" style="display:none">
        <div class="email-header">
            <div class="email-subject">ç³»ç»Ÿæ¯æ—¥æ•°æ®æŠ¥å‘Š</div>
            <div class="email-meta">
                <span>å‘ä»¶äºº: system.admin@company.com</span>
                <span>æ”¶ä»¶äºº: user@company.com</span>
                <span>æ—¥æœŸ: <span id="emailDate">--/--/----</span></span>
            </div>
        </div>
        
        <div class="email-toolbar">
            <div class="tool-button">å›å¤</div>
            <div class="tool-button">è½¬å‘</div>
            <div class="tool-button">åˆ é™¤</div>
        </div>
        
        <div class="email-body">
            <div class="input-group">
                <input 
                    type="text" 
                    id="emailCodeInput" 
                    placeholder="è¾“å…¥æŸ¥è¯¢ä»£ç "
                    maxlength="6"
                >
                <button id="emailSyncButton">æŸ¥è¯¢</button>
            </div>
            
            <div class="status-box">
                <div id="emailDisplayValue">--.--</div>
                <div id="emailUpdateTime">æ¥æ”¶æ—¶é—´: --:--:--</div>
                <div id="emailErrorMsg"></div>
            </div>
            
            <div class="fake-content">
                <p>å°Šæ•¬çš„ç”¨æˆ·ï¼š</p>
                <p>è¿™æ˜¯æ‚¨è¯·æ±‚çš„ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆçš„æ•°æ®æŠ¥å‘Šï¼Œå¦‚éœ€æ›´å¤šä¿¡æ¯ï¼Œè¯·ä½¿ç”¨ä¸Šæ–¹æŸ¥è¯¢åŠŸèƒ½ã€‚</p>
                <p>æ­¤è‡´</p>
                <p>ç³»ç»Ÿç®¡ç†å‘˜</p>
            </div>
        </div>
        
        <div class="email-footer">
            è¿™æ˜¯ä¸€å°ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆçš„é‚®ä»¶ï¼Œè¯·å‹¿ç›´æ¥å›å¤
        </div>
    </div>
    
    <!-- é¡¹ç›®ç®¡ç†é£æ ¼å®¹å™¨ -->
    <div class="container jira-container" style="display:none">
        <div class="jira-header">
            <div class="jira-logo">JIRA</div>
            <div class="jira-nav">
                <div class="jira-nav-item">ä»ªè¡¨ç›˜</div>
                <div class="jira-nav-item">é¡¹ç›®</div>
                <div class="jira-nav-item">é—®é¢˜</div>
                <div class="jira-nav-item">æŠ¥è¡¨</div>
            </div>
        </div>
        
        <div class="jira-content">
            <div class="jira-sidebar">
                <div class="sidebar-title">é¡¹ç›®</div>
                <ul class="sidebar-menu">
                    <li>æ•°æ®ç›‘æ§ç³»ç»Ÿ</li>
                    <li>è´¢åŠ¡æŠ¥å‘Šå·¥å…·</li>
                    <li>å¸‚åœºåˆ†æå¹³å°</li>
                </ul>
                
                <div class="sidebar-title">ç­›é€‰å™¨</div>
                <ul class="sidebar-menu">
                    <li>æˆ‘çš„å¾…åŠäº‹é¡¹</li>
                    <li>æœ€è¿‘æŸ¥çœ‹</li>
                    <li>å·²åˆ†é…ç»™æˆ‘</li>
                </ul>
            </div>
            
            <div class="jira-main">
                <div class="jira-issue">
                    <div class="issue-header">
                        <div class="issue-key">DATA-123</div>
                        <div class="issue-status">è¿›è¡Œä¸­</div>
                    </div>
                    
                    <div class="input-group">
                        <input 
                            type="text" 
                            id="jiraCodeInput" 
                            placeholder="è¾“å…¥ä»»åŠ¡ID"
                            maxlength="6"
                        >
                        <button id="jiraSyncButton">æ›´æ–°</button>
                    </div>
                    
                    <div class="status-box">
                        <div id="jiraDisplayValue">--.--</div>
                        <div id="jiraUpdateTime">æœ€åä¿®æ”¹: --:--:--</div>
                        <div id="jiraErrorMsg"></div>
                    </div>
                    
                    <div class="fake-content">
                        <p>ä»»åŠ¡æè¿°ï¼šç›‘æ§å®æ—¶æ•°æ®</p>
                        <p>è´Ÿè´£äººï¼šç³»ç»Ÿç®¡ç†å‘˜</p>
                        <p>æˆªæ­¢æ—¥æœŸï¼š<span id="jiraDueDate">--/--/----</span></p>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="jira-footer">
            JIRA - é¡¹ç›®ä¸é—®é¢˜è·Ÿè¸ªå·¥å…·
        </div>
    </div>
    
    <!-- æ•°æ®åº“æŸ¥è¯¢é£æ ¼å®¹å™¨ -->
    <div class="container sql-container" style="display:none">
        <div class="sql-toolbar">
            <div class="sql-button">æ‰§è¡Œ</div>
            <div class="sql-button">ä¿å­˜</div>
            <div class="sql-button">è¿æ¥</div>
        </div>
        
        <div class="sql-content">
            <div class="sql-sidebar">
                <div>æ•°æ®åº“è¿æ¥</div>
                <ul class="database-list">
                    <li>market_data</li>
                    <li>financial_db</li>
                    <li>user_info</li>
                </ul>
            </div>
            
            <div class="sql-main">
                <div class="query-editor">
                    <div>> SELECT * FROM market_data</div>
                    <div>> WHERE stock_code = '<span id="sqlDisplayCode">000001</span>'</div>
                    <div>> AND date = CURRENT_DATE;</div>
                </div>
                
                <div class="input-group">
                    <input 
                        type="text" 
                        id="sqlCodeInput" 
                        placeholder="è¾“å…¥æŸ¥è¯¢ä»£ç "
                        maxlength="6"
                    >
                    <button id="sqlSyncButton">æ‰§è¡Œ</button>
                </div>
                
                <div class="status-box">
                    <div id="sqlDisplayValue">--.--</div>
                    <div id="sqlUpdateTime">æŸ¥è¯¢æ—¶é—´: --:--:--</div>
                    <div id="sqlErrorMsg"></div>
                </div>
                
                <div class="query-results">
                    <table class="result-table">
                        <tr>
                            <th>stock_code</th>
                            <th>price</th>
                            <th>time</th>
                        </tr>
                        <tr>
                            <td id="sqlResultCode">000001</td>
                            <td id="sqlResultValue">--.--</td>
                            <td id="sqlResultTime">--:--:--</td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ä½¿ç”¨localStorageå­˜å‚¨è‚¡ç¥¨ä»£ç å’Œçš®è‚¤è®¾ç½®
        const STORAGE_KEY = 'lastStockCode';
        const SKIN_KEY = 'currentSkin';
        let currentCode = '';
        let updateInterval;
        
        // çš®è‚¤é…ç½®
        const skins = [
            {
                id: 'default',
                name: 'é»˜è®¤ç®€çº¦',
                containers: ['.default-container'],
                inputId: '#codeInput',
                buttonId: '#syncButton',
                displayId: '#displayValue',
                timeId: '#updateTime',
                errorId: '#errorMsg'
            },
            {
                id: 'it-mode',
                name: 'è¿ç»´ç›‘æ§',
                containers: ['.it-container'],
                inputId: '#itCodeInput',
                buttonId: '#itSyncButton',
                displayId: '#itDisplayValue',
                timeId: '#itUpdateTime',
                errorId: '#itErrorMsg'
            },
            {
                id: 'excel-mode',
                name: 'ExcelæŠ¥è¡¨',
                containers: ['.excel-container'],
                inputId: '#excelCodeInput',
                buttonId: '#excelSyncButton',
                displayId: '#excelDisplayValue',
                timeId: '#excelUpdateTime',
                errorId: '#excelErrorMsg',
                extraBindings: [
                    {
                        elementId: '#excelDisplayCode',
                        targetId: '#excelCodeInput'
                    }
                ]
            },
            {
                id: 'email-mode',
                name: 'é‚®ä»¶ç³»ç»Ÿ',
                containers: ['.email-container'],
                inputId: '#emailCodeInput',
                buttonId: '#emailSyncButton',
                displayId: '#emailDisplayValue',
                timeId: '#emailUpdateTime',
                errorId: '#emailErrorMsg',
                onActivate: function() {
                    const now = new Date();
                    document.getElementById('emailDate').textContent = 
                        `${now.getFullYear()}/${now.getMonth()+1}/${now.getDate()}`;
                }
            },
            {
                id: 'jira-mode',
                name: 'é¡¹ç›®ç®¡ç†',
                containers: ['.jira-container'],
                inputId: '#jiraCodeInput',
                buttonId: '#jiraSyncButton',
                displayId: '#jiraDisplayValue',
                timeId: '#jiraUpdateTime',
                errorId: '#jiraErrorMsg',
                onActivate: function() {
                    const now = new Date();
                    document.getElementById('jiraDueDate').textContent = 
                        `${now.getFullYear()}/${now.getMonth()+1}/${now.getDate()+7}`;
                }
            },
            {
                id: 'sql-mode',
                name: 'æ•°æ®åº“æŸ¥è¯¢',
                containers: ['.sql-container'],
                inputId: '#sqlCodeInput',
                buttonId: '#sqlSyncButton',
                displayId: '#sqlDisplayValue',
                timeId: '#sqlUpdateTime',
                errorId: '#sqlErrorMsg',
                extraBindings: [
                    {
                        elementId: '#sqlDisplayCode',
                        targetId: '#sqlCodeInput'
                    },
                    {
                        elementId: '#sqlResultCode',
                        targetId: '#sqlCodeInput'
                    }
                ]
            }
        ];
        let currentSkinIndex = 0;
        
        // åˆå§‹åŒ–çš®è‚¤
        function initSkin() {
            const savedSkin = localStorage.getItem(SKIN_KEY);
            if(savedSkin) {
                const index = skins.findIndex(skin => skin.id === savedSkin);
                if(index >= 0) {
                    currentSkinIndex = index;
                    applySkin(skins[currentSkinIndex]);
                }
            } else {
                applySkin(skins[0]);
            }
        }
        
        // åº”ç”¨çš®è‚¤
        function applySkin(skin) {
            // éšè—æ‰€æœ‰å®¹å™¨
            document.querySelectorAll('.container').forEach(el => {
                el.style.display = 'none';
            });
            
            // æ˜¾ç¤ºå½“å‰çš®è‚¤å®¹å™¨
            skin.containers.forEach(selector => {
                document.querySelector(selector).style.display = 'block';
            });
            
            // åŒæ­¥è¾“å…¥æ¡†å€¼
            const mainInput = document.getElementById('codeInput');
            const skinInput = document.querySelector(skin.inputId);
            if(mainInput && skinInput) {
                skinInput.value = mainInput.value;
            }
            
            // ç»‘å®šæŒ‰é’®äº‹ä»¶
            const skinButton = document.querySelector(skin.buttonId);
            if(skinButton) {
                skinButton.onclick = startTracking;
            }
            
            // ç»‘å®šé¢å¤–å…ƒç´ 
            if(skin.extraBindings) {
                skin.extraBindings.forEach(binding => {
                    const element = document.querySelector(binding.elementId);
                    const target = document.querySelector(binding.targetId);
                    if(element && target) {
                        target.addEventListener('input', function() {
                            element.textContent = this.value;
                        });
                    }
                });
            }
            
            // æ‰§è¡Œçš®è‚¤ç‰¹å®šçš„æ¿€æ´»å‡½æ•°
            if(skin.onActivate) {
                skin.onActivate();
            }
            
            // æ›´æ–°å½“å‰çš®è‚¤ç´¢å¼•
            currentSkinIndex = skins.findIndex(s => s.id === skin.id);
            
            // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
            localStorage.setItem(SKIN_KEY, skin.id);
            
            // æ›´æ–°bodyçš„class
            document.body.className = skin.id;
        }
        
        // åˆ‡æ¢çš®è‚¤
        function toggleSkin() {
            currentSkinIndex = (currentSkinIndex + 1) % skins.length;
            applySkin(skins[currentSkinIndex]);
        }
        
        // ä»æœ¬åœ°å­˜å‚¨è·å–ä¸Šæ¬¡çš„è‚¡ç¥¨ä»£ç 
        function getLastStockCode() {
            return localStorage.getItem(STORAGE_KEY) || '000001';
        }
        
        // ä¿å­˜å½“å‰è‚¡ç¥¨ä»£ç åˆ°æœ¬åœ°å­˜å‚¨
        function saveStockCode(code) {
            localStorage.setItem(STORAGE_KEY, code);
        }
        
        function showError(message) {
            const currentSkin = skins[currentSkinIndex];
            const errorElem = document.querySelector(currentSkin.errorId);
            if(errorElem) {
                errorElem.textContent = message;
                setTimeout(() => errorElem.textContent = '', 3000);
            }
        }
        
        function formatEastMoneyPrice(price) {
            if(price === null || price === undefined) return '--.--';
            const num = Number(price);
            if(isNaN(num)) return '--.--';
            return (num / 100).toFixed(2);
        }
        
        // ä½¿ç”¨ä¸œæ–¹è´¢å¯ŒAPIè·å–è‚¡ç¥¨æ•°æ®
        async function getStockPrice(code) {
            try {
                // åˆ¤æ–­æ˜¯æ²ªå¸‚(6å¼€å¤´)è¿˜æ˜¯æ·±å¸‚(0/3å¼€å¤´)
                const market = code.startsWith('6') ? '1' : '0';
                const apiUrl = `https://push2.eastmoney.com/api/qt/stock/get?secid=${market}.${code}&fields=f43,f58&_=${Date.now()}`;
                
                const response = await fetch(apiUrl, {
                    headers: {
                        'Referer': 'https://data.eastmoney.com/',
                        'User-Agent': 'Mozilla/5.0'
                    }
                });
                
                if(!response.ok) throw new Error(`ç½‘ç»œè¯·æ±‚å¤±è´¥: ${response.status}`);
                
                const data = await response.json();
                
                if(data.data === null || data.rc !== 0) {
                    throw new Error('æ— æ•ˆè‚¡ç¥¨ä»£ç ');
                }
                
                // ä¸œæ–¹è´¢å¯ŒAPIè¿”å›çš„ä»·æ ¼éœ€è¦é™¤ä»¥100
                const price = data.data.f43 || data.data.f58;
                if(price === null || price === undefined) {
                    throw new Error('æœªèƒ½è·å–æœ‰æ•ˆä»·æ ¼æ•°æ®');
                }
                
                return {
                    value: formatEastMoneyPrice(price),
                    time: new Date().toLocaleTimeString('zh-CN', {hour12: false})
                };
            } catch (error) {
                showError("æ•°æ®è·å–å¤±è´¥: " + error.message);
                console.error('è·å–è‚¡ç¥¨æ•°æ®å‡ºé”™:', error);
                return null;
            }
        }
        
        async function updateDisplay() {
            const currentSkin = skins[currentSkinIndex];
            const button = document.querySelector(currentSkin.buttonId);
            if(button) {
                button.disabled = true;
                button.textContent = currentSkin.name === 'é»˜è®¤ç®€çº¦' ? 'æŸ¥è¯¢ä¸­...' : 'å¤„ç†ä¸­...';
            }
            
            const data = await getStockPrice(currentCode);
            
            if(button) {
                button.disabled = false;
                button.textContent = currentSkin.name === 'é»˜è®¤ç®€çº¦' ? 'æŸ¥è¯¢' : 
                                    currentSkin.name === 'è¿ç»´ç›‘æ§' ? 'æ‰§è¡Œ' :
                                    currentSkin.name === 'ExcelæŠ¥è¡¨' ? 'åˆ·æ–°' :
                                    currentSkin.name === 'é‚®ä»¶ç³»ç»Ÿ' ? 'æŸ¥è¯¢' :
                                    currentSkin.name === 'é¡¹ç›®ç®¡ç†' ? 'æ›´æ–°' : 'æ‰§è¡Œ';
            }
            
            if(!data) return;
            
            // æ›´æ–°æ‰€æœ‰çš®è‚¤å¯¹åº”çš„æ˜¾ç¤ºå…ƒç´ 
            skins.forEach(skin => {
                const displayElem = document.querySelector(skin.displayId);
                const timeElem = document.querySelector(skin.timeId);
                const errorElem = document.querySelector(skin.errorId);
                
                if(displayElem) displayElem.textContent = data.value;
                if(timeElem) timeElem.textContent = `${
                    skin.name === 'é»˜è®¤ç®€çº¦' ? 'æœ€ååŒæ­¥' :
                    skin.name === 'è¿ç»´ç›‘æ§' ? 'æœ€åæ›´æ–°' :
                    skin.name === 'ExcelæŠ¥è¡¨' ? 'æ›´æ–°æ—¶é—´' :
                    skin.name === 'é‚®ä»¶ç³»ç»Ÿ' ? 'æ¥æ”¶æ—¶é—´' :
                    skin.name === 'é¡¹ç›®ç®¡ç†' ? 'æœ€åä¿®æ”¹' : 'æŸ¥è¯¢æ—¶é—´'
                }: ${data.time}`;
                if(errorElem) errorElem.textContent = '';
            });
            
            // æ›´æ–°SQLç»“æœè¡¨æ ¼
            const sqlResultValue = document.getElementById('sqlResultValue');
            const sqlResultTime = document.getElementById('sqlResultTime');
            if(sqlResultValue) sqlResultValue.textContent = data.value;
            if(sqlResultTime) sqlResultTime.textContent = data.time;
            
            document.title = data.value;
        }
        
        function startTracking() {
            const currentSkin = skins[currentSkinIndex];
            const input = document.querySelector(currentSkin.inputId);
            if(!input) return;
            
            const code = input.value.trim();
            if(!/^\d{6}$/.test(code)) {
                showError("è¯·è¾“å…¥6ä½æœ‰æ•ˆç¼–ç ");
                return;
            }
            
            // åŒæ­¥æ‰€æœ‰è¾“å…¥æ¡†çš„å€¼
            skins.forEach(skin => {
                const skinInput = document.querySelector(skin.inputId);
                if(skinInput) skinInput.value = code;
            });
            
            currentCode = code;
            saveStockCode(currentCode);
            
            if(updateInterval) clearInterval(updateInterval);
            
            updateDisplay();
            updateInterval = setInterval(updateDisplay, 10000);
        }
        
        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            // åˆå§‹åŒ–çš®è‚¤
            initSkin();
            
            // è®¾ç½®çš®è‚¤åˆ‡æ¢æŒ‰é’®äº‹ä»¶
            document.getElementById('skinToggle').addEventListener('click', toggleSkin);
            
            // ä»æœ¬åœ°å­˜å‚¨è·å–ä¸Šæ¬¡çš„è‚¡ç¥¨ä»£ç 
            currentCode = getLastStockCode();
            
            // è®¾ç½®æ‰€æœ‰è¾“å…¥æ¡†çš„å€¼
            skins.forEach(skin => {
                const input = document.querySelector(skin.inputId);
                if(input) input.value = currentCode;
            });
            
            // å¼€å§‹è·Ÿè¸ª
            startTracking();
        });
    </script>
</body>
</html>
